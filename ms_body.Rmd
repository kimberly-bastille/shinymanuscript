---
title: |
  **Recreational Fisheries Decision Support Tool: A shiny app for Fisheries Managers**
author: 
- Kimberly Bastille
- Andrew Carr-Harris
- Scott Steinback
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document:
    fig_caption: yes
    keep_tex: yes
    latex_engine: pdflatex
fontfamily: mathpazo
fontsize: 11pt
geometry: margin = 1in
header-includes:
- \usepackage{setspace}\doublespacing
- \usepackage[left]{lineno}
- \linenumbers
- \usepackage{dcolumn}
- \usepackage{caption}
- \usepackage{float}
- \usepackage{afterpage}
- \usepackage{siunitx}
- \usepackage{amsmath}
keywords: 
bibliography: ./refs.bib
csl: ./american-fisheries-society.csl
abstract: |
---


## Introduction

Recreational fisheries managers are challenged with making decisions that will impact millions of individuals and their communities. To make informed decisions, managers partner with scientists whose mission it is to provide the scientific information and tools necessary for productive, sustainable, and healthy marine ecosystems and coastal communities (@NEFSC_2024).  This partnership, mandated by the Magnuson-Stevens Fishery Conservation and Management Act (@MSA_1976)faces several challenges. These include disparities in technical expertise between managers and scientists and the time-intensive nature of the complex mathematical computations underlying the scientific findings shared.  Such issues are particularly evident in the Summer Flounder (*Paralichthys dentatus*), Black Sea Bass (*Centropristis striata*), and Scup (*Stenotomus chrysops*) recreational fisheries in the U.S. Mid-Atlantic region. In this paper, we discuss how we were able to overcome these barriers by building and disseminating a recreational fisheries decision support tool - an R shiny application for fisheries managers. Our approach followed the software development life cycle and prioritized collaboration efforts.  
  

R shiny applications have gained considerable popularity since their debut in 2016 (@Kasprzak2021).  Over the past nine years, numerous applications have been developed for fisheries management, including tools for exploring reference points (@Huynh2023), generating reports (@Noleto-Filho2021, @dragonfly_2024), and monitoring fish populations (@Tilley2020).The recreational fisheries decision support tool shiny application stands out as the first of its kind to be directly integrated into the management regulation setting process. This novel approach is made feasible by the specific management strategy employed in this fishery. 


In 2022, the Mid-Atlantic Fishery Management Council and the Atlantic States Marine Fisheries Commission adopted the “Percent Change Approach” for setting recreational regulations (size limit, possession limit, and open fishing season) (@MAFMC_2022).  This approach looks at two factors when determining when a change in management regulations should remain status-quo, be liberalized, or be restricted - 1) Confidence interval around expected harvest under status-quo regulations and 2) biomass compared to target. Together, these two factors determine the percent change in harvest estimate for the following two year management period (@MSA_2023). The expected harvest is estimated from a recreation demand model that analyzes how adjustments to size limits, possession limits, and fishing season durations affect harvest quantities, discard rates, fishing effort, and fishery’s economic value (@Carr-Harris2024). 

The Decision Support Tool uses the recreation demand model to calculate the outputs required by managers to meet the percent change required by the above approach. It incorporates catch-per-trip data from the Marine Recreational Information Program, length distributions from stock assessments, and angler behavior from a discrete choice experiment (@Carr-Harris2024).The outputs provide estimates of harvest and discards (as well as dead discards) in both pounds and numbers of fish, estimates of effort in number of trips, and an estimate of angler satisfaction in U.S. dollars. The model distinguishes between three fishing modes: shore, private boat and for-hire boat fishing.
 
In 2023, we developed the R shiny application decision support tool which provides managers with a user-friendly interface to interact directly with the model. The development of this application has fundamentally changed the workflow for determining recreational fishing regulations for these species. The previous method required an individual model developer to run the model over 200 times on their local machine. Managers would email the modeler requesting different regulation alternatives and that individual would then email the results in a day or two. This new approach significantly enhances efficiency and flexibility in the decision-making process by allowing managers to run the model autonomously in the cloud in fewer than 20 minutes.  

## Software Developement Life Cycle

Viewing this Decision Support Tool Application not only as a product but as an iterative workflow allows us to apply the traditional software development framework. There are many ways to visualize Software Development Life Cycle models (@Shylesh 2017). For this project we focus on the circular workflow (Figure 1) due to the iterative nature of fisheries management. The framework consists of six phases (Strategy, Design, Development, Testing, Deployment, and Maintenance). In each phase of the framework we engaged the recreational fisheries managers for whom the tool was built. We believe this collaboration helped us build a useful and intuitive product that the managers were excited to implement. 

```{r SDLC, echo=FALSE, fig.cap="Figure 1. Software development life cycle visualization describing the workflow applied to build and maintain the Recreational Fisheries Decision Support Tool Shiny Application. (https://nix-united.com/blog/software-development-life-cycle-nix-approach-to-sdlc/) ", out.width = '100%'}
knitr::include_graphics(here::here("images/SDLC.png"))
```


### Strategy

The first step is to understand the problem, understand the requirements of that problem, and to plan (@Gurung2020, @Mishra2013, and @Shylesh2017). Our goal was to create a tool that would allow summer flounder, black sea bass, and scup recreational fisheries managers in the U.S. Mid-Atlantic region to interact with a recreation demand model used for decision-making. The tool needed to provide the ability for managers to assess how changes in bag limits, possession limits, and open fishing seasons  impact estimates of harvest, discards, fishing effort, and the economic value of the fisheries. Additionally, the tool had to meet specific technical requirements, including online accessibility and the ability to operate within a reasonable timeframe.

Our strategy to meet these needs included: 1) to develop a shiny application; 2) to deploy that application in the cloud; and 3) to engage managers throughout the project to both update them on the progress and to seek feedback. We believed this approach would ensure the developed tool would effectively meet fisheries managers’ needs in their regulatory decision-making process. 

### Design

After establishing our strategy, we began planning the execution. Given our small team of one app developer and one modeler, serving approximately 30 users, we formed a working  group comprising individuals interested in Summer Flounder, Black Sea Bass, and Scup Recreational Management in the Mid-Atlantic region of the U.S. (https://www.fisheries.noaa.gov/event/recreational-demand-model-decision-support-tool-working-group-summer-flounder-black-sea-bass). This group included state and federal managers, stock assessment scientists, and other stakeholders.

Throughout the six month development period, we held monthly meetings to facilitate communication about the product. Through this engagement, it became clear that flexibility was the users’ most desired attribute. To address this need, we incorporated two key features:  the ability to split management by mode, allowing states to manage shore, private boat, and for-hire boat fishing separately with a single click, and the option to add fishing seasons, removing previous limitations on the number of seasons managers could implement. This co-design approach with users not only insured their investment in the tool but also gave us confidence that it would effectively meet their needs, ultimately bridging the gap between developers and end-users and resulting in a more tailored and user-friendly application. 

### Development

The Decision Support Tool Shiny Application was developed in R shiny, an R package that allows programmers to build web applications (@shiny2022). This interactive application enables non-technical users to interact with R code directly (@Wickham2021), and thus, run the recreation demand model independently. Our development process was collaborative, coinciding with regular design input from the tool’s intended users. This approach facilitated monthly progress updates, demonstrating how we incorporated user feedback into each iteration of the application. The result is a tool that closely aligns with user needs and expectations, bridging the gap between complex statistical modeling and practical fisheries management. 

Throughout the application development we were also making improvements to the underlying recreation demand model. The model enhancements served to expand the tool’s capabilities and better account for the inherent uncertainty in the underlying data (@Carr-Harris2024). We maintained transparent communication with the tool’s users regarding these improvements. During model-focused meetings, we actively sought their input on data decisions and solicited feedback on the model itself. Additionally, we presented a detailed overview of the model to ensure users viewed the application not as a mysterious black box, but as an accessible front-end interface for a model they understood. 

The shiny application features three main components. The first is the “Regulation Selection” tab (Figure 2) where users can select which state(s) they wish to explore outcomes. When a state is selected, the default management regulations are displayed, reflecting the previous year’s rules. Users can then adjust the open fishing season (the period during which anglers can legally keep fish), possession limit (the number of fish an individual angler can keep per day), and/or the size limit (the minimum size of fish that can be kept) for species identified for restrictions or liberalization based on the Percent Change Approach.  

```{r RegulationSelection, echo=FALSE, fig.cap="Figure 2: Recreational Fisheries Decision Support Tool Shiny Application “Regulation Selection” tab showing New York selected. ", out.width = '100%'}
knitr::include_graphics(here::here("images/fig2.png"))
```


The second component is the “Results” tab (Figure 3). On this tab, users can view how the regulations chosen affect estimates of harvest, discards, fishing effort, and angler satisfaction. The results are displayed across five tables, all of which can be downloaded for later review and comparison between alternatives. 
The first table shows the regulations selected by the user. The second table presents changes in angler satisfaction, quantified as the compensating variation (CV) generated from changes in fishing trip outcomes in U.S. dollars (tech memo). The third table (harvest table) is accessed most frequently, and displays the status-quo regulations, alternative regulations, percent differences between the status-quo and alternatives, and the percentage of model runs under the harvest target. These metrics are presented for each selected state and for all modes. The fourth table presents the same metrics excluding percent under target for the estimated discards and dead discards. Finally, the last table outputs estimates of fishing effort measured by the number of trips expected under the alternative regulations. 
 

```{r ResultsTab, echo=FALSE, fig.cap="Figure 3: Recreational Fisheries Decision Support Tool Shiny Application “Results” tab showing top tables of model outputs for NY.  ", out.width = '100%'}
knitr::include_graphics(here::here("images/fig3.png"))
```

The percent difference between status-quo and the alternatives is the metric used in the Percent Change Approach, making it the most critical variable for this application. The other values are provided as supplementary information to assist managers in making the best decisions for their anglers. Since this was the first year that managers would see the outputs in this format to inform their management decisions, we created a decision tree to guide them in utilizing the non-harvest variables (Figure 4). In collaboration with managers, we discussed how they would use the tool and shared our vision of how they might interpret and apply the results. 

```{r DecisionTree, echo=FALSE, fig.cap="Figure 4: Recreational fisheries decision support tool decision tree: a framework for helping managers use the tool to inform their decision making process.", out.width = '100%'}
knitr::include_graphics(here::here("images/fig4.png"))
```

The decision tree consists of five steps, primarily featuring questions that managers can ask themselves while using the decision support tool. The primary objective for managers is to achieve the liberalizations or reductions prescribed by the Percent Change Approach - 28% reduction for summer flounder and 10% reduction for scup in 2024. The secondary goals will vary based on angler interests in each state. For example, one state might prioritize optimizing angler satisfaction, while another may focus on reducing discards. To address both objectives, managers can run multiple iterations of the model using various alternative regulations that they believe will meet their primary goals. Once they identify 3-4 alternative management measures that comply with the requirements of the Percent Change Approach, they can compare results to align with their secondary goals, whatever they may be. This strategy enables managers to present multiple options to their anglers and facilitates open communication and understanding throughout the regulation setting process. 


### Testing

The application was tested in multiple stages throughout the development and deployment phases. A beta version of the application with limited capabilities (restricted to one state) was made available for users to explore and test when the application was deployed in the cloud. At this stage, we were still expanding the application to include the other eight states, but we wanted users to familiarize themselves with the tool before their management decisions were due. 

In the grander scale, this initial iteration served as a test for the deployment in the cloud. We were uncertain about the level of usage the application would receive during this process. The insights gained from this first year will inform future budgeting decisions and guide the strategy and design phases for related projects, specifically the development of a similar decision support tool for the Gulf of Maine Cod and Haddock recreational fishery. 

### Deployment

To enhance the shiny application and address user concerns about the time required to run the model and compile results, we deployed the shiny application using Microsoft Azure Cloud Services. This approach allowed users to access the tool directly, thereby eliminating the reliance on individual scientists to compute the necessary information for management decisions. The workflow, developed by Microsoft cloud engineers (Figure 5), effectively meets the processing power demands of the model while providing users with a public-facing website to access the tool.   

```{r backend, echo=FALSE, fig.cap="Figure 5. Azure deployment visualization outlining the backend workflow developed by Azure Cloud Engineers.", out.width = '100%'}
knitr::include_graphics(here::here("images/fig5.png"))
```

Multiple software tools were used to meet these needs within Azure. The process is containerized using Docker (@docker2014) allowing us to package our data and code, and port those to any machine. Having the code in a container means we can spin up as many instances of the model as there are active users allowing each user is working in their own container. 

First ShinyProxy deploys and manages the shiny application (https://www.shinyproxy.io/). To do this, it spins up a docker container which contains the data pathways, code, and configuration necessary to run the shiny application. Once the container exists Kubernetes, a container management system (https://kubernetes.io/), uses a scheduler to assign the container to a virtual machine. This process happens each time a user logs in through the Azure login portal at recreationalfisheriesdst.com, meaning each individual user is running the shiny application and interacting with the recreation demand model in their own workspace and thus, not competing or queuing for runtime. 

The number of virtual machines is scalable meaning as usage of the tool increases more machines can be created and when users log out or time out of their session the virtual machine they were working on can be shut down. This helps manage the cost of the Azure services as we needed to drastically increase the size of the virtual machines used for this application. Increasing the size of the machines from 32G and 16 cores to 756G and 36 cores allowed us to parallel process (using the “futures” R package) the 100 iterations of the underlying model instead of sequentially processing in a for loop as was previously done. This significantly reduced the amount of time to run a single model from about 6 hours to about 15 minutes per state. Fifteen minutes is much more reasonable for the users though future reduction in runtime was requested. 

### Maintenance

#### Open Science

It is well documented that embracing open science strategies and tools results in increased efficiency, transparency, and repeatability in iterative workflows (@Bastille2020, @Lowndes2017). Applying those same principles here ensures that 1) we can more efficiently work with our current and future selves by setting up protocols for storing and documenting data and code and 2) users of the tool have access to the backend preventing potential contentions with lack of transparency (https://github.com/kimberly-bastille/rdmtool). 

Storing code developed on a local machine on github allows the app developer the ability to make quick changes to the application and pick up those changes in the Azure workspace.  This addresses (1) by pulling the updated code version in Azure and rebuilding the docker image used to build the container. Both minor and major changes to the shiny app can be made available to users in minutes by using this workflow. This allows us to efficiently maintain the application in the short and long term. Pushing and pulling to a public github repository means there is a documented timeline of improvements made to the application in a place available to those interested in deep-diving into the application code thus addressing (2). Improvements and decision points can be found in the working group meeting notes but can also be seen in the commit history of the repository. 

#### User Survey

In preparing for the next management cycle, we surveyed the users to gather feedback on how they would like to see the application and their user experience improve for next year. We will be using this list of ideas to prioritize what features to include in the strategy and design phases of the next lap around the Software Development Life Cycle. A major take away from this survey is that the app “was intuitive to use” and that users felt ownership of the product and invested in its continued improvement. Moving forward, we will continue our collaboration strategy by engaging the users both in formal meetings, more casual office hours, and in written feedback. This allows users to interact with developers in the format they are most comfortable using meaning we are gathering feedback from everyone and not just the loudest voices in the room. 

## Conclusion

Applying the Software Development Life Cycle for a recreational fisheries management decision support tool allowed us to follow a systematic framework for meeting the needs of our users and our tool. The six steps outlined above are not one-off practices and the order could vary slightly as we iteratively improve the product. There are three major takeaways from this workflow. First to engage the stakeholders, in this case the recreational fisheries managers, early and often. This builds trust and ensures that the final product is adapted to individual needs. We engaged the managers in each step of the framework and because of this we were able to deliver a product that was used directly in management regulation setting. 

Second, is to embrace technology. Delivering this tool to managers in six months would not have been possible without deploying the shiny application in Azure. This tool needed to overcome two main barriers to usage (1) the runtime and (2) it needed to be public facing and accessible to users. Cloud services solved both of these challenges. By combining R’s parallel processing capabilities and the larger virtual machines available in the cloud space we were able to dramatically reduce the runtime and through Azure cloud services we were also able to purchase a website domain (recreationalfisheriesdst.com) and deploy the application there making the tool available online to those with the link and a login. 

Lastly is to ensure transparency. Transparency in all forms means showing our users what is behind the model, reinforcing the first major takeaway, openly discussing the capabilities and limitations of the tool, and using open science strategies and softwares to ease future work. Tools like Git enable the application developer to quickly work with themselves on different machines to update the tool by passing the code through the version control software. This makes the code available to those interested in the math behind the model, and allows model and application developers to collaborate with each other more efficiently. Transparency in each phase of the framework leads to more efficient work and greater trust in the product developed. 

Moving forward we expect this workflow to change and adapt as we continue to collaborate with recreational fisheries managers to develop a decision support tool that can meet their needs and inform their decision making process. We plan to use their feedback and the lessons learned from this first cycle to make improvements to the model, application, and deployment of the tool. We will continue to apply the six phases of the Software Development Life Cycle (Strategy, Design, Development, Testing, Deployment, and Maintenance) for this application and will follow that same practices and apply the lessons learned as we expand the tool to include Gulf of Maine recreational Cod and Haddock which are managed using a similar model by the New England Fisheries Management Council. 

## References











